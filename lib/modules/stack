function stack.trace {
	local offset="${1:-0}";
	local frame=$offset line;
	local data=( $( caller $frame ) );
	while [ "${#data[@]}" -gt 0 ]; do
		error "%s:%s %s" "${data[2]}" "${data[0]}" "${data[1]}";
		((frame++));
		data=( $( caller $frame ) );
	done
}

function throw {
	local message="${1:-Unknown error}";
	error "$message";
	stack.trace 1;
}